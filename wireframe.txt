How we will build helloRun step-by-step

Phase 0: Project skeleton (MVC baseline) âœ… COMPLETED

Goal: You can run the app locally with pages loading.

What you built:
âœ… Express server
âœ… EJS views with layouts
âœ… MVC folders structure
âœ… MongoDB connection
âœ… Base layout + navigation + footer components
âœ… Mobile-responsive navigation with hamburger menu
âœ… Lucide icons integration

Folder structure (MVC):
hellorun/
  src/
    config/
      db.js âœ…
      session.js âœ…
    controllers/
      auth.controller.js âœ…
      page.controller.js âœ…
    middleware/
      auth.middleware.js âœ…
      role.middleware.js âœ…
    models/
      User.js âœ…
      Counter.js âœ…
      OrganiserApplication.js âœ…
      Event.js âœ…
      Registration.js âœ…
      Submission.js âœ…
    routes/
      authRoutes.js âœ…
      page.routes.js âœ…
      organizer.routes.js âœ… (NEW - just created)
      event.routes.js âœ…
      admin.routes.js âœ…
    services/
      password.service.js âœ…
      email.service.js âœ…
      counter.service.js âœ…
      upload.service.js âœ… (NEW - just created)
    scripts/
      initCounter.js âœ…
      migrateUserIds.js âœ…
      drop-userId-index.js âœ…
    views/
      layouts/
        main.ejs âœ…
        nav.ejs âœ…
        footer.ejs âœ…
      pages/
        index.ejs âœ…
        events.ejs âœ…
      auth/
        login.ejs âœ…
        signup.ejs âœ…
        forgot-password.ejs âœ…
        reset-password.ejs âœ…
        reset-password-expired.ejs âœ…
        reset-email-sent.ejs âœ…
        reset-success.ejs âœ…
        resend-verification.ejs âœ…
        verify-email-sent.ejs âœ… (NEW - just created)
        verify-email-success.ejs âœ…
        verify-email-expired.ejs âœ…
        verify-email-result.ejs âœ… (NEW - just created)
      organizer/
        complete-profile.ejs âœ… (NEW - placeholder created)
        application-status.ejs âœ… (NEW - placeholder created)
      error.ejs âœ…
    public/
      css/
        style.css âœ…
        login.css âœ…
        signup.css âœ…
      js/
        main.js âœ… (mobile menu, Lucide icons)
        auth.js âœ… (password visibility toggle)
        signup.js âœ… (password strength, validation)
      images/
        helloRun-icon.webp âœ…
      uploads/
        organizer-docs/ âœ… (NEW - created for document uploads)
      sitemap.xml âœ…
      robots.txt âœ…
    server.js âœ…
  .env âœ…
  .env.example âœ…
  .gitignore âœ…
  package.json âœ…
  README.md âœ…
  dir.text âœ…
  dns.txt âœ…
  wireframe.txt âœ…
  sitemap.md âœ…

What you have after Phase 0:
âœ… / home page (fully styled with hero, features, audience sections)
âœ… /events events page (UI ready for dynamic content)
âœ… /login and /signup pages (fully functional UI)
âœ… Complete password reset flow (forgot, reset, success, expired)
âœ… Complete email verification flow (sent, success, expired, resend)
âœ… Error page
âœ… Responsive navigation with mobile menu
âœ… Footer with links
âœ… SEO ready (sitemap.xml, robots.txt)

---

Phase 1: Auth (MongoDB) with email verification âœ… COMPLETED (100%)

Goal: Users can sign up, verify email, and log in securely.

Feature 1A: Email/password signup âœ… COMPLETED
âœ… Create User model with email verification fields
âœ… Auto-increment userId (U000001, U000002, etc.)
âœ… Counter model for sequential IDs
âœ… Hash password with bcrypt
âœ… Block duplicate email
âœ… Save role: "runner" or "organiser"
âœ… Generate email verification token (24 hours expiry)
âœ… Send verification email via Resend
âœ… Password strength validation (real-time)
âœ… Password visibility toggle
âœ… Floating label inputs
âœ… Client-side validation
âœ… Server-side validation
âœ… Terms & Conditions agreement
âœ… Both /signup and /register routes work (POST & GET)
âœ… Redirect to "verify-email-sent" page after signup
âœ… Role selection during signup (runner/organiser)

Feature 1B: Email verification âœ… COMPLETED
âœ… Verify email token
âœ… Mark user as verified (emailVerified = true)
âœ… Handle expired tokens
âœ… Resend verification email
âœ… Rate limiting (1 email per hour)
âœ… Track verification email count
âœ… Beautiful email templates
âœ… Professional email design with gradient
âœ… Role-aware verification flow:
  - Runners â†’ Redirect to home (/?verified=true)
  - Organisers â†’ Redirect to /organizer/complete-profile
âœ… Auto-login after email verification
âœ… Session management on verification

Feature 1C: Password reset âœ… COMPLETED
âœ… Request password reset
âœ… Generate reset token (1 hour expiry)
âœ… Send reset email via Resend
âœ… Verify reset token
âœ… Update password
âœ… Handle expired tokens
âœ… Rate limiting (3 resets per 24 hours)
âœ… Email notifications
âœ… Confirmation email after password reset

Feature 1D: Login/logout âœ… COMPLETED
âœ… Login page UI
âœ… Verify email is verified before login
âœ… Verify password with bcrypt
âœ… Create session cookie
âœ… Session management
âœ… Logout clears session
âœ… Redirect to home after login
âœ… Role-based dashboard routing (future)

Feature 1E: Protect routes âœ… COMPLETED
âœ… Middleware: requireAuth
âœ… Middleware: requireRole("admin")
âœ… Middleware: requireRole("organiser")
âœ… Middleware: requireApprovedOrganizer
âœ… Redirect to login if not authenticated
âœ… Created auth.middleware.js with all role checks

User model fields (current):
âœ… userId (auto-increment: 1, 2, 3...)
âœ… userIdFormatted (virtual: U000001)
âœ… email (unique, indexed)
âœ… firstName (2-50 chars)
âœ… lastName (2-50 chars)
âœ… passwordHash (hashed with bcrypt, 8+ chars, uppercase, lowercase, number)
âœ… role: "runner" (default), "organiser", "admin"
âœ… emailVerified (boolean)
âœ… emailVerificationToken (24 hours expiry)
âœ… emailVerificationExpires
âœ… passwordResetToken (1 hour expiry)
âœ… passwordResetExpires
âœ… passwordResetEmailCount (rate limiting)
âœ… passwordResetEmailLastSent
âœ… organizerApplicationId (reference to OrganiserApplication) âœ… NEW
âœ… organizerStatus: "not_applied", "pending", "approved", "rejected" âœ… NEW
âœ… createdAt
âœ… updatedAt (auto-updated)

User model methods (NEW):
âœ… canApplyAsOrganizer() - checks if can apply to be organizer
âœ… hasActiveApplication() - checks if has pending application
âœ… isApprovedOrganizer() - checks if approved organizer
âœ… canReceivePasswordResetEmail() - rate limiting check
âœ… incrementPasswordResetEmailCount() - tracks reset attempts

Rule enforced:
âœ… Email must be unique across all users
âœ… Password must meet strength requirements (8+ chars, uppercase, lowercase, number)
âœ… Email verification required before login
âœ… Organisers can also participate as runners (dual capability)
âœ… organizerStatus separate from role (allows pending state)

Technical Stack (Phase 1):
âœ… bcryptjs (password hashing)
âœ… express-session (session management)
âœ… Resend API (email service)
âœ… crypto (token generation)
âœ… Mongoose (MongoDB ODM)
âœ… Counter model (auto-increment IDs)
âœ… multer (file uploads) âœ… NEW

---

Phase 2: Organiser application + manual approval ğŸ”„ IN PROGRESS (30%)

Goal: Runner can apply to become organiser. Admin can approve.

Feature 2A: Organiser signup flow âœ… COMPLETED
âœ… User signs up and selects "Event Organizer" role
âœ… Email verification sent (same as runner)
âœ… After verification, redirect to /organizer/complete-profile
âœ… Upload service created (multer configuration)
âœ… File validation (PDF, JPEG, PNG only, max 5MB)
âœ… Secure file storage in /public/uploads/organizer-docs/
âœ… Organizer routes created (/organizer/*)
âœ… OrganiserApplication model created with fields:
  - applicationId (auto-increment: APP000001)
  - userId (reference)
  - businessName
  - businessType (individual, company, ngo, sports_club)
  - contactPhone
  - businessRegistrationNumber
  - businessAddress
  - idProofUrl (required)
  - businessProofUrl (required)
  - additionalInfo
  - status: pending, under_review, approved, rejected
  - rejectionReason
  - reviewedBy (admin reference)
  - reviewedAt
  - submittedAt
  - createdAt, updatedAt

Feature 2B: Document upload & profile completion â³ IN PROGRESS (50%)
âœ… Upload service configured (multer)
âœ… File type validation (PDF, JPG, PNG)
âœ… File size validation (max 5MB)
âœ… Secure filename generation (userId_timestamp_random)
âœ… Storage directory created
âœ… Organizer routes skeleton created
â³ Complete profile form UI (NEXT - needs full form)
â³ File upload with drag-and-drop
â³ File preview before upload
â³ Progress indicators
â³ Form validation (business info)
â³ Submit application handler
â³ Email notification on submission

Feature 2C: Admin reviews â³ TODO
â³ Admin dashboard page
â³ List all applications
â³ Filter by status (pending, approved, rejected)
â³ View application details
â³ View uploaded documents
â³ Approve: sets user role to "organiser" + organizerStatus to "approved"
â³ Reject: stores reason and notifies applicant
â³ Email notifications for approval/rejection
â³ Admin routes (/admin/applications)

Feature 2D: Application status page â³ TODO
âœ… Basic placeholder created
â³ Show current status (pending, approved, rejected)
â³ Show submission date
â³ Show estimated review time
â³ If rejected: show reason + option to reapply
â³ If approved: congratulations + link to create event

OrganiserApplication model: âœ… CREATED
âœ… All fields defined
âœ… Auto-increment applicationId
âœ… Indexes on userId, status, createdAt
âœ… Timestamps enabled
âœ… Counter integration

Upload service: âœ… CREATED
âœ… uploadOrganizerDocs middleware
âœ… File type validation
âœ… File size validation
âœ… Secure storage
âœ… Unique filename generation
âœ… deleteFile helper
âœ… validateFiles helper

Environment variables added:
âœ… UPLOAD_MAX_SIZE=5242880
âœ… UPLOAD_ALLOWED_TYPES=image/jpeg,image/png,application/pdf
âœ… ADMIN_EMAIL
âœ… ORGANIZER_REVIEW_TIME_DAYS=3

Files structure updated:
âœ… src/models/OrganiserApplication.js
âœ… src/services/upload.service.js
âœ… src/routes/organizer.routes.js
âœ… src/middleware/auth.middleware.js (updated)
âœ… src/views/organizer/complete-profile.ejs (placeholder)
âœ… src/views/organizer/application-status.ejs (placeholder)
âœ… public/uploads/organizer-docs/ (directory)
âœ… .gitignore updated for uploads

NEXT IMMEDIATE STEPS FOR PHASE 2:
1. â³ Create complete-profile form UI with document upload
2. â³ Implement POST /organizer/complete-profile handler
3. â³ Add email templates (application-submitted, approved, rejected)
4. â³ Update email.service.js with new methods
5. â³ Create admin dashboard for reviewing applications
6. â³ Create admin views for reviewing applications
7. â³ Test full organizer application flow
8. â³ Deploy Phase 2 to production

---

Phase 3: Event creation (organiser) ğŸ“… PENDING

Goal: Approved organisers can create and publish events.

Feature 3A: Create event â³ TODO
â³ Organiser dashboard
â³ Create event form
â³ Draft mode
â³ Publish event
â³ Store payment instructions
â³ Upload event banner/images
â³ Set event categories (5K, 10K, Half Marathon, etc.)

Feature 3B: Events list + event details â³ TODO
â³ Public events list page (filter by category, date, status)
â³ Event details page
â³ "Join Event" registration button
â³ Display organiser info
â³ Display payment instructions
â³ Show participant count

Event model needs:
â³ eventId (custom format)
â³ organiserId (userId reference)
â³ title
â³ description
â³ category (5K, 10K, etc.)
â³ startDate
â³ endDate
â³ registrationDeadline
â³ fee
â³ paymentInstructions
â³ bannerUrl
â³ status: "draft", "published", "closed", "cancelled"
â³ maxParticipants
â³ currentParticipants
â³ createdAt
â³ updatedAt

---

Phase 4: Registration + payment proof ğŸ’³ PENDING

Goal: Runner joins event and uploads payment proof for verification.

Feature 4A: Join event â³ TODO
â³ Registration form
â³ Upload payment proof
â³ Create registration with status: "pending_verification"
â³ Email confirmation to runner
â³ Notification to organiser

Feature 4B: Organiser verifies payment â³ TODO
â³ Organiser view registrations
â³ View payment proof
â³ Approve registration (status: "verified")
â³ Reject with reason
â³ Email notification to runner
â³ Runner can only submit results after verification

Registration model needs:
â³ registrationId (custom format)
â³ eventId (reference)
â³ userId (reference)
â³ paymentProofUrl
â³ paymentStatus: "pending_verification", "verified", "rejected"
â³ rejectionReason
â³ verifiedBy (organiser userId)
â³ verifiedAt
â³ createdAt

---

Phase 5: Submissions + approval ğŸƒ PENDING

Goal: Runner submits run proof, organiser approves, certificate becomes available.

Feature 5A: Submit result â³ TODO
â³ Submission form (distance, time, date)
â³ Upload proof (screenshot, photo)
â³ Create submission with status: "pending"
â³ Email notification to organiser

Feature 5B: Organiser approves â³ TODO
â³ View all submissions for event
â³ Review proof
â³ Approve submission (status: "approved")
â³ Reject with reason
â³ Mark completion
â³ Generate certificate

Feature 5C: Certificates â³ TODO
â³ Auto-generate certificate PDF
â³ Runner can download certificate
â³ Display on runner dashboard
â³ Email certificate to runner

Submission model needs:
â³ submissionId (custom format)
â³ registrationId (reference)
â³ eventId (reference)
â³ userId (reference)
â³ distance
â³ time
â³ completionDate
â³ proofUrl
â³ status: "pending", "approved", "rejected"
â³ rejectionReason
â³ certificateUrl
â³ reviewedBy (organiser userId)
â³ reviewedAt
â³ createdAt

---

Phase 6: Dashboards & Analytics ğŸ“Š PENDING

Goal: Users see their progress, organisers see event metrics.

Feature 6A: Runner Dashboard â³ TODO
â³ Upcoming events
â³ Past events
â³ Activity log
â³ Certificates earned
â³ Progress statistics

Feature 6B: Organiser Dashboard â³ TODO
â³ Event overview
â³ Participant statistics
â³ Pending registrations count
â³ Pending submissions count
â³ Revenue tracking

Feature 6C: Admin Dashboard â³ TODO
â³ Platform statistics
â³ User growth
â³ Event trends
â³ Pending applications
â³ System health

---

Phase 7: Additional Pages & Features ğŸŒŸ PENDING

Feature 7A: Static Pages â³ TODO
â³ /about - About HelloRun
â³ /how-it-works - Platform guide
â³ /contact - Contact form
â³ /faq - Frequently asked questions
â³ /blog - Running tips and articles
â³ /privacy - Privacy policy
â³ /terms - Terms of service

Feature 7B: Search & Filters â³ TODO
â³ Search events
â³ Filter by category
â³ Filter by date range
â³ Filter by location (if applicable)

Feature 7C: Notifications â³ TODO
â³ In-app notifications
â³ Email preferences
â³ Notification history

---

Phase 8: Google OAuth (Optional) ğŸ” PENDING

Goal: Users can sign up/login with Google.

â³ Google OAuth setup
â³ Passport.js integration
â³ Merge accounts (if email exists)
â³ Handle authProvider: "google"

---

Phase 9: Testing & Optimization ğŸ§ª PENDING

â³ Unit tests for services
â³ Integration tests for routes
â³ Performance optimization
â³ Security audit
â³ Mobile responsiveness testing
â³ Cross-browser testing
â³ Load testing

---

Phase 10: Deployment ğŸš€ PENDING

â³ Set up production database
â³ Configure environment variables
â³ Set up SSL certificate
â³ Deploy to hosting platform (Render)
â³ Configure domain (hellorun.online)
â³ Set up monitoring
â³ Set up backups
â³ Launch!

---

CURRENT STATUS: Phase 2 (Organiser Applications) - 30% Complete

COMPLETED FEATURES (Phase 1 & 2A):
âœ… Complete user authentication system
âœ… Email verification with role-aware routing
âœ… Password reset with rate limiting
âœ… Session management
âœ… Route protection middleware
âœ… User model with organizer fields
âœ… OrganiserApplication model
âœ… Upload service with file validation
âœ… Organizer routes skeleton
âœ… Basic organizer views (placeholders)
âœ… Both /signup and /register routes
âœ… verify-email-sent page
âœ… Role-based email verification flow

IN PROGRESS:
ğŸ”„ Complete profile form UI with document upload (40%)
ğŸ”„ Application submission handler (0%)
ğŸ”„ Email notifications for applications (0%)

NEXT IMMEDIATE STEPS:
1. Create complete-profile.ejs full form UI
2. Add drag-and-drop file upload
3. Implement POST /organizer/complete-profile handler
4. Add email templates (submitted, approved, rejected)
5. Update email.service.js
6. Create admin dashboard for reviewing applications
7. Test end-to-end organizer application flow

TECHNICAL DEBT / NOTES:
- Need to initialize Counter for organiserApplication
- File uploads stored locally (consider cloud storage for production)
- Admin email notifications need to be tested
- Consider adding file size warnings on upload
- May need to add virus scanning for uploaded files (production)

DEPLOYMENT STATUS:
- Development: âœ… Working (localhost:3000)
- Production (Render): âš ï¸ Phase 1 deployed, Phase 2 pending
- Domain: hellorun.online
- Database: MongoDB Atlas (Cluster0)
- Email Service: Resend API (verified domain: hellorun.online)

REPOSITORY:
- GitHub: https://github.com/4hprojects/helloRun
- Last Push: January 30, 2026
- Branch: main

DEPENDENCIES ADDED:
âœ… multer (file uploads)
âœ… bcryptjs (password hashing)
âœ… express-session (sessions)
âœ… resend (email service)
âœ… mongoose (MongoDB ODM)
âœ… crypto (built-in - token generation)